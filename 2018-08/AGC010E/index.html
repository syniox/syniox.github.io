<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>[AGC010E]Rearranging - Blog | qzkszj</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0/normalize.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0/build/pure-min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0/build/grids-responsive-min.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js/styles/atom-one-light.css"><style>.category-list-item{display:flex}.category-list-link{flex:1 0 auto}.category-list-count{text-align:right}.post .post-content pre code{padding:0 0}</style><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Blog | qzkszj" type="application/atom+xml"></head><body class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">[AGC010E]Rearranging</h1><a id="logo" href="/">Blog | qzkszj</a><p class="description">过往如烟。</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa undefined">Home</i></a><a href="/archives/"><i class="fa undefined"> Archive</i></a><a href="/about/"><i class="fa undefined"> About</i></a><a href="/atom.xml"><i class="fa undefined"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">[AGC010E]Rearranging</h1><div class="post-meta">August 10,2018<span> | </span><span class="category"><a href="/categories/Solution/">Solution</a></span><span> | 528,2 mins.</span><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span></span><span id="busuanzi_container_page_pv"> | views: <span id="busuanzi_value_page_pv"></span></span></div><div class="tags"><a href="/tags/%E6%8B%93%E6%89%91/">拓扑</a></div><div class="post-content"><p><a target="_blank" rel="noopener" href="https://agc010.contest.atcoder.jp/tasks/agc010_e">AGC010E</a></p><p>日常找性质。</p><ul><li>对于两个不互质的数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a,b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">b</span></span></span></span>，他们的相对顺序不会被改变。</li></ul><p>其实这一条也就够了。。</p><p>把原序列中所有gcd不为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>的对都连上边，这样我们就得到了一个简单无向图。<br>对于每一个联通块，先手要做一些事情。<br>对于这个联通块建立序列的某个位置，先手必须要保证它最小，而且这个联通块中与他互质并比他大的数不能通过交换达到这个位置。<br>那也就是说必须通过gcd链到达那个点，那个点才不会“篡位”<br>先手的最优策略是把每个连通块最小的点作为起点，然后每次找到最小且没走过的点走过去。<br>这样对于每个联通块直接从最小的点开始从小到大深搜建立拓扑图正好就是想要的东西了。<br>后手就是每次找入度为0且的点中最大的，然后把这个点删掉。</p><p><a target="_blank" rel="noopener" href="https://github.com/syniox/Online_Judge_solutions/blob/master/AtCoder/AGC010E.cpp">code</a>:</p><pre><code class="hljs language-cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstring&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;queue&gt;</span></span>
<span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">2002</span>;
<span class="hljs-type">int</span> n,hx[N],in[N],fir[N];
<span class="hljs-type">bool</span> vis[N];
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">edge</span>&#123;
	<span class="hljs-type">int</span> to,nx;
&#125;eg[N*<span class="hljs-number">10</span>];
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;
	<span class="hljs-type">int</span> x,v;
	<span class="hljs-type">bool</span> <span class="hljs-keyword">operator</span> &lt; (<span class="hljs-type">const</span> node &amp;b) <span class="hljs-type">const</span> &#123;
		<span class="hljs-keyword">return</span> v&lt;b.v;
	&#125;
&#125;;
std::priority_queue &lt;node&gt; pq;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">gcd</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span>&#123;
	<span class="hljs-keyword">return</span> y?<span class="hljs-built_in">gcd</span>(y,x%y):x;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b)</span></span>&#123;
	<span class="hljs-type">static</span> <span class="hljs-type">int</span> cnt;
	eg[++cnt]=(edge)&#123;b,fir[a]&#125;;
	fir[a]=cnt;
	eg[++cnt]=(edge)&#123;a,fir[b]&#125;;
	fir[b]=cnt;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">char</span> <span class="hljs-title">gtc</span><span class="hljs-params">()</span></span>&#123;
	<span class="hljs-type">static</span> <span class="hljs-type">char</span> buf[<span class="hljs-number">20000</span>],*h,*t;
	<span class="hljs-keyword">if</span>(h==t)&#123;
		t=(h=buf)+<span class="hljs-built_in">fread</span>(buf,<span class="hljs-number">1</span>,<span class="hljs-number">20000</span>,stdin);
	&#125;
	<span class="hljs-keyword">return</span> h==t?EOF:*h++;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">nxi</span><span class="hljs-params">()</span></span>&#123;
	<span class="hljs-type">int</span> x=<span class="hljs-number">0</span>;
	<span class="hljs-type">char</span> c;
	<span class="hljs-keyword">while</span>((c=<span class="hljs-built_in">getchar</span>())&gt;<span class="hljs-string">&#x27;9&#x27;</span>||c&lt;<span class="hljs-string">&#x27;0&#x27;</span>);
	<span class="hljs-keyword">while</span>(x=x*<span class="hljs-number">10</span>+c<span class="hljs-number">-48</span>,(c=<span class="hljs-built_in">getchar</span>())&gt;=<span class="hljs-string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="hljs-string">&#x27;9&#x27;</span>);
	<span class="hljs-keyword">return</span> x;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;
	vis[x]=<span class="hljs-number">1</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)&#123;
		<span class="hljs-keyword">if</span>(!vis[i]&amp;&amp;<span class="hljs-built_in">gcd</span>(hx[i],hx[x])!=<span class="hljs-number">1</span>)&#123;
			++in[i];
			<span class="hljs-built_in">add</span>(x,i);
			<span class="hljs-built_in">dfs</span>(i);
		&#125;
	&#125;
&#125;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
<span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> ONLINE_JUDGE</span>
	<span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;a.in&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
	n=<span class="hljs-built_in">nxi</span>();
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i) hx[i]=<span class="hljs-built_in">nxi</span>();
	std::<span class="hljs-built_in">sort</span>(hx+<span class="hljs-number">1</span>,hx+n+<span class="hljs-number">1</span>);
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)&#123;
		<span class="hljs-keyword">if</span>(!vis[i]) pq.<span class="hljs-built_in">push</span>((node)&#123;i,hx[i]&#125;),<span class="hljs-built_in">dfs</span>(i);
	&#125;
	<span class="hljs-keyword">while</span>(!pq.<span class="hljs-built_in">empty</span>())&#123;
		node x=pq.<span class="hljs-built_in">top</span>();
		pq.<span class="hljs-built_in">pop</span>();
		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,x.v);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=fir[x.x];i;i=eg[i].nx)&#123;
			<span class="hljs-type">int</span> y=eg[i].to;
			<span class="hljs-keyword">if</span>(--in[y]==<span class="hljs-number">0</span>) pq.<span class="hljs-built_in">push</span>((node)&#123;y,hx[y]&#125;);
		&#125;
	&#125;
	<span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre></div><div class="page-navigator"><a class="pre" href="/2018-08/AGC013D/">Previous</a><a class="next" href="/2018-08/ARC083E/">Next</a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><div class="widget-title">Categories</div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Note/">Note</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Recollections/">Recollections</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Solution/">Solution</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Starred/">Starred</a><span class="category-list-count">5</span></li></ul></div><div class="widget"><div class="widget-title">Tags</div><div class="tagcloud"><a href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" style="font-size:15px">组合数学</a> <a href="/tags/DP-%E4%BC%98%E5%8C%96/" style="font-size:15px">DP/优化</a> <a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size:16px">数论</a> <a href="/tags/%E5%AE%B9%E6%96%A5/" style="font-size:13px">容斥</a> <a href="/tags/%E9%9B%86%E5%90%88/" style="font-size:13px">集合</a> <a href="/tags/%E5%81%8F%E5%BA%8F/" style="font-size:13px">偏序</a> <a href="/tags/%E6%A0%91/" style="font-size:13px">树</a> <a href="/tags/%E6%8B%93%E6%89%91/" style="font-size:13px">拓扑</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" style="font-size:14px">网络流</a> <a href="/tags/%E7%BB%93%E8%AE%BA/" style="font-size:13px">结论</a> <a href="/tags/%E7%BE%A4%E8%AE%BA/" style="font-size:13px">群论</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">字符串</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/" style="font-size:13px">线性代数</a> <a href="/tags/%E7%9F%A9%E9%98%B5/" style="font-size:13px">矩阵</a> <a href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" style="font-size:14px">多项式</a> <a href="/tags/%E6%94%AF%E9%85%8D%E6%A0%91/" style="font-size:13px">支配树</a> <a href="/tags/%E5%9B%BE%E8%AE%BA/" style="font-size:14px">图论</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size:13px">数学</a></div></div><div class="widget"><div class="widget-title">Links</div><ul class="links-list"><li class="links-list-item"><a href="https://cnblogs.com/dedicatus545" title="dedicatus545" target="_blank">dedicatus545</a></li></ul><ul class="links-list"><li class="links-list-item"><a href="https://blog.sshockwave.net" title="sshockwave" target="_blank">sshockwave</a></li></ul><ul class="links-list"><li class="links-list-item"><a href="https://www.cnblogs.com/dcdcbigbig/" title="DCDCbigbig" target="_blank">DCDCbigbig</a></li></ul><ul class="links-list"><li class="links-list-item"><a href="https://www.cnblogs.com/JackyhhJuRuo/" title="Jackyhh" target="_blank">Jackyhh</a></li></ul></div></div></div></div><div id="footer">© <a href="/" real="nofollow">Blog | qzkszj.</a><i> Powered by </i><a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a></div></body></html>