<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>[ARC080F]Prime Flip - Blog | qzkszj</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0/normalize.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0/build/pure-min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0/build/grids-responsive-min.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js/styles/atom-one-light.css"><style>.category-list-item{display:flex}.category-list-link{flex:1 0 auto}.category-list-count{text-align:right}.post .post-content pre code{padding:0 0}</style><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Blog | qzkszj" type="application/atom+xml"></head><body class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">[ARC080F]Prime Flip</h1><a id="logo" href="/">Blog | qzkszj</a><p class="description">过往如烟。</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa undefined">Home</i></a><a href="/archives/"><i class="fa undefined"> Archive</i></a><a href="/about/"><i class="fa undefined"> About</i></a><a href="/atom.xml"><i class="fa undefined"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">[ARC080F]Prime Flip</h1><div class="post-meta">August 14,2018<span> | </span><span class="category"><a href="/categories/Solution/">Solution</a></span><span> | 708,3 mins.</span><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span></span><span id="busuanzi_container_page_pv"> | views: <span id="busuanzi_value_page_pv"></span></span></div><div class="tags"><a href="/tags/%E6%95%B0%E8%AE%BA/">数论</a><a href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/">网络流</a></div><div class="post-content"><p><a target="_blank" rel="noopener" href="https://arc080.contest.atcoder.jp/tasks/arc080_d">ARC080F</a></p><p><s>没有证明，但没人找到反例当然就能用啊</s><br>将序列差分，特判一下0。<br>考虑消掉两个为1的位置i,j 如果|i−j|是奇质数，那么需要1次操作<br>如果|i−j|是偶数，那么根据哥德巴赫猜想，大于等于6的偶数都能分解为两个奇质数之和，那么只需要两次。2的话可以5-3得到，4可以7-3得到<br>如果|i−j|是奇合数，那么需要3次。一次将它变成偶数，然后同第二次<br>将所有的差分后的位置按照奇和偶分成两组<br>我们尽量要让一次操作的多</p><p>那么差为奇质数的连边，跑二分图最大匹配</p><p>剩下的尽量同组匹配（差为偶数）<br>最后每组最多剩下一个，直接匹配即可<br><a target="_blank" rel="noopener" href="https://github.com/syniox/Online_Judge_solutions/blob/master/AtCoder/ARC080F.cpp">code</a>:</p><pre><code class="hljs language-cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstring&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cmath&gt;</span></span>
<span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">102</span>;
<span class="hljs-type">int</span> n,cnp,cnj,cnt,og[N],hx[N&lt;&lt;<span class="hljs-number">1</span>],fir[N&lt;&lt;<span class="hljs-number">1</span>],prm[<span class="hljs-number">460</span>];
<span class="hljs-type">bool</span> npr[<span class="hljs-number">3200</span>];
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">edge</span>&#123;
	<span class="hljs-type">int</span> to,wi,nx;
&#125;eg[N*N];

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b,<span class="hljs-type">int</span> v)</span></span>&#123;
	<span class="hljs-type">static</span> <span class="hljs-type">int</span> cnt=<span class="hljs-number">1</span>;
	eg[++cnt]=(edge)&#123;b,v,fir[a]&#125;;
	fir[a]=cnt;
	eg[++cnt]=(edge)&#123;a,<span class="hljs-number">0</span>,fir[b]&#125;;
	fir[b]=cnt;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">char</span> <span class="hljs-title">get_c</span><span class="hljs-params">()</span></span>&#123;
	<span class="hljs-type">static</span> <span class="hljs-type">char</span> buf[<span class="hljs-number">20000</span>],*h,*t;
	<span class="hljs-keyword">if</span>(h==t)&#123;
		t=(h=buf)+<span class="hljs-built_in">fread</span>(buf,<span class="hljs-number">1</span>,<span class="hljs-number">20000</span>,stdin);
	&#125;
	<span class="hljs-keyword">return</span> h==t?EOF:*h++;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">nxi</span><span class="hljs-params">()</span></span>&#123;
	<span class="hljs-type">int</span> x=<span class="hljs-number">0</span>;
	<span class="hljs-type">char</span> c;
	<span class="hljs-keyword">while</span>((c=<span class="hljs-built_in">get_c</span>())&gt;<span class="hljs-string">&#x27;9&#x27;</span>||c&lt;<span class="hljs-string">&#x27;0&#x27;</span>);
	<span class="hljs-keyword">while</span>(x=x*<span class="hljs-number">10</span><span class="hljs-number">-48</span>+c,(c=<span class="hljs-built_in">get_c</span>())&gt;=<span class="hljs-string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="hljs-string">&#x27;9&#x27;</span>);
	<span class="hljs-keyword">return</span> x;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>&#123;
	npr[<span class="hljs-number">1</span>]=<span class="hljs-number">1</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">2</span>;i&lt;<span class="hljs-number">3200</span>;++i)&#123;
		<span class="hljs-keyword">if</span>(!npr[i]) prm[++cnp]=i;
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=cnp&amp;&amp;i*prm[j]&lt;<span class="hljs-number">3200</span>;++j)&#123;
			npr[i*prm[j]]=<span class="hljs-number">1</span>;
			<span class="hljs-keyword">if</span>(i%prm[j]==<span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;
		&#125;
	&#125;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">bool</span> <span class="hljs-title">ispr</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;
	<span class="hljs-keyword">if</span>(x&lt;<span class="hljs-number">3200</span>) <span class="hljs-keyword">return</span> !npr[x];
	<span class="hljs-type">int</span> sq=<span class="hljs-built_in">sqrt</span>(x)+<span class="hljs-number">1</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;prm[i]&lt;=sq;++i)&#123;
		<span class="hljs-keyword">if</span>(x%prm[i]==<span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
	&#125;
	<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
&#125;

<span class="hljs-keyword">namespace</span> F&#123;
	<span class="hljs-type">int</span> dep[N&lt;&lt;<span class="hljs-number">1</span>],que[N&lt;&lt;<span class="hljs-number">1</span>],cur[N&lt;&lt;<span class="hljs-number">1</span>];

	<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">bool</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span>&#123;
		<span class="hljs-built_in">memset</span>(dep,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(dep));
		<span class="hljs-type">int</span> hd=<span class="hljs-number">0</span>,tl=<span class="hljs-number">1</span>;
		dep[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>;
		<span class="hljs-keyword">while</span>(hd!=tl)&#123;
			<span class="hljs-type">int</span> x=que[hd++];
			<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=cur[x]=fir[x];i;i=eg[i].nx)&#123;
				<span class="hljs-type">int</span> y=eg[i].to;
				<span class="hljs-keyword">if</span>(eg[i].wi&amp;&amp;!dep[y])&#123;
					dep[y]=dep[x]+<span class="hljs-number">1</span>;
					que[tl++]=y;
				&#125;
			&#125;
		&#125;
		<span class="hljs-keyword">return</span> dep[(N&lt;&lt;<span class="hljs-number">1</span>)<span class="hljs-number">-1</span>];
	&#125;

	<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> t)</span></span>&#123;
		<span class="hljs-keyword">if</span>(x==(N&lt;&lt;<span class="hljs-number">1</span>)<span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> t;
		<span class="hljs-type">int</span> tp,tt=t;
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> &amp;i=cur[x];i;i=eg[i].nx)&#123;
			<span class="hljs-type">int</span> y=eg[i].to,v=eg[i].wi;
			<span class="hljs-keyword">if</span>(v&amp;&amp;tt&amp;&amp;dep[x]+<span class="hljs-number">1</span>==dep[y]&amp;&amp;(tp=<span class="hljs-built_in">dfs</span>(y,std::<span class="hljs-built_in">min</span>(v,tt))))&#123;
				eg[i].wi-=tp;
				eg[i^<span class="hljs-number">1</span>].wi+=tp;
				tt-=tp;
				<span class="hljs-keyword">if</span>(!tt) <span class="hljs-keyword">break</span>;
			&#125;
		&#125;
		<span class="hljs-keyword">return</span> t-tt;
	&#125;
&#125;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
<span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> ONLINE_JUDGE</span>
<span class="hljs-comment">//	freopen(&quot;c.in&quot;,&quot;r&quot;,stdin);</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
	<span class="hljs-built_in">init</span>();
	n=<span class="hljs-built_in">nxi</span>();
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)&#123;
		og[i]=<span class="hljs-built_in">nxi</span>();
	&#125;
	std::<span class="hljs-built_in">sort</span>(og+<span class="hljs-number">1</span>,og+n+<span class="hljs-number">1</span>);
	og[<span class="hljs-number">0</span>]=<span class="hljs-number">-1</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)&#123;
		<span class="hljs-keyword">if</span>(og[i]-og[i<span class="hljs-number">-1</span>]&gt;<span class="hljs-number">1</span>)&#123;
			<span class="hljs-keyword">if</span>(og[i<span class="hljs-number">-1</span>]+<span class="hljs-number">1</span>) hx[++cnt]=og[i<span class="hljs-number">-1</span>]+<span class="hljs-number">1</span>;
			hx[++cnt]=og[i];
		&#125;
	&#125;
	hx[++cnt]=og[n]+<span class="hljs-number">1</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=cnt;++i)&#123;
		<span class="hljs-keyword">if</span>(hx[i]&amp;<span class="hljs-number">1</span>) ++cnj;
		<span class="hljs-keyword">if</span>(hx[i]&amp;<span class="hljs-number">1</span>) <span class="hljs-built_in">add</span>(<span class="hljs-number">0</span>,i,<span class="hljs-number">1</span>);
		<span class="hljs-keyword">else</span> <span class="hljs-built_in">add</span>(i,(N&lt;&lt;<span class="hljs-number">1</span>)<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=i+<span class="hljs-number">1</span>;j&lt;=cnt;++j)&#123;
			<span class="hljs-type">int</span> p=hx[j]-hx[i];
			<span class="hljs-keyword">if</span>((p&amp;<span class="hljs-number">1</span>)&amp;&amp;<span class="hljs-built_in">ispr</span>(p))&#123;
				<span class="hljs-keyword">if</span>(hx[i]&amp;<span class="hljs-number">1</span>) <span class="hljs-built_in">add</span>(i,j,<span class="hljs-number">1</span>);
				<span class="hljs-keyword">else</span> <span class="hljs-built_in">add</span>(j,i,<span class="hljs-number">1</span>);
			&#125;
		&#125;
	&#125;
	<span class="hljs-type">int</span> ans=<span class="hljs-number">0</span>;
	<span class="hljs-keyword">while</span>(F::<span class="hljs-built_in">bfs</span>())&#123;
		ans+=F::<span class="hljs-built_in">dfs</span>(<span class="hljs-number">0</span>,N);
	&#125;
	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,cnt-ans+((cnj-ans)&amp;<span class="hljs-number">1</span>));
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre></div><div class="page-navigator"><a class="pre" href="/2018-08/AGC008F/">Previous</a><a class="next" href="/2018-08/AGC013D/">Next</a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><div class="widget-title">Categories</div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Note/">Note</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Recollections/">Recollections</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Solution/">Solution</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Starred/">Starred</a><span class="category-list-count">5</span></li></ul></div><div class="widget"><div class="widget-title">Tags</div><div class="tagcloud"><a href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" style="font-size:15px">组合数学</a> <a href="/tags/DP-%E4%BC%98%E5%8C%96/" style="font-size:15px">DP/优化</a> <a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size:16px">数论</a> <a href="/tags/%E5%AE%B9%E6%96%A5/" style="font-size:13px">容斥</a> <a href="/tags/%E9%9B%86%E5%90%88/" style="font-size:13px">集合</a> <a href="/tags/%E5%81%8F%E5%BA%8F/" style="font-size:13px">偏序</a> <a href="/tags/%E6%A0%91/" style="font-size:13px">树</a> <a href="/tags/%E6%8B%93%E6%89%91/" style="font-size:13px">拓扑</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" style="font-size:14px">网络流</a> <a href="/tags/%E7%BB%93%E8%AE%BA/" style="font-size:13px">结论</a> <a href="/tags/%E7%BE%A4%E8%AE%BA/" style="font-size:13px">群论</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">字符串</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/" style="font-size:13px">线性代数</a> <a href="/tags/%E7%9F%A9%E9%98%B5/" style="font-size:13px">矩阵</a> <a href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" style="font-size:14px">多项式</a> <a href="/tags/%E6%94%AF%E9%85%8D%E6%A0%91/" style="font-size:13px">支配树</a> <a href="/tags/%E5%9B%BE%E8%AE%BA/" style="font-size:14px">图论</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size:13px">数学</a></div></div><div class="widget"><div class="widget-title">Links</div><ul class="links-list"><li class="links-list-item"><a href="https://cnblogs.com/dedicatus545" title="dedicatus545" target="_blank">dedicatus545</a></li></ul><ul class="links-list"><li class="links-list-item"><a href="https://blog.sshockwave.net" title="sshockwave" target="_blank">sshockwave</a></li></ul><ul class="links-list"><li class="links-list-item"><a href="https://www.cnblogs.com/dcdcbigbig/" title="DCDCbigbig" target="_blank">DCDCbigbig</a></li></ul><ul class="links-list"><li class="links-list-item"><a href="https://www.cnblogs.com/JackyhhJuRuo/" title="Jackyhh" target="_blank">Jackyhh</a></li></ul></div></div></div></div><div id="footer">© <a href="/" real="nofollow">Blog | qzkszj.</a><i> Powered by </i><a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a></div></body></html>